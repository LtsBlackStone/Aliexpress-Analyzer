# 角色：速卖通数据分析助手开发专家

## 1. 项目概况
请使用 Next.js (App Router) 和 Tailwind CSS 开发一个专业的"速卖通商品数据分析工具"。
**核心原则**：所有数据处理必须在浏览器本地完成，严禁调用任何外部 AI API，以确保数据隐私和极速响应。

## 2. 技术栈要求
- 框架：Next.js (App Router) + Tailwind CSS + TypeScript
- 数据处理库：
    - `xlsx`: 处理 .xlsx 格式文件读取
    - `xlsx-js-style`: 导出带样式的 Excel 文件
    - `papaparse`: 处理 .csv 格式文件
    - `jschardet`: 用于 CSV 编码检测（必须解决速卖通导出的 GBK 乱码问题）
- 图标库：`lucide-react`

## 3. 数据读取与字段映射
支持拖拽或点击上传文件（.csv, .xlsx）。必须严格从源文件中提取以下精确命名的列：
- **商品ID**: 对应列名 "商品ID" (字符串类型)
- **访客数**: 对应列名 "访客数" (数字类型)
- **支付转化率**: 对应列名 "支付转化率" (数字类型，原始数据格式如 0.02，代表 2%)
- **加购数**: 对应列名 "商品加购人数" (数字类型)
- **收藏数**: 对应列名 "商品收藏人数" (数字类型)
- **搜索点击率**: 对应列名 "搜索点击率" (数字类型)

**特殊情况处理**：
- 如果是 CSV 文件，必须先检测编码（支持 GBK），防止中文乱码。
- 若某商品访客数为 0，则其"收藏加购访客比"判定为 0。
- 忽略表格中除上述 6 个核心字段外的所有冗余列。

## 4. 纯前端分析引擎逻辑
请在前端 JavaScript 中硬编码实现以下逻辑：
- **指标计算**：
    - `Avg_V` (平均访客量) = 所有商品访客数总和 / 商品总数
    - `Avg_CR` (平均支付转化率) = 所有商品支付转化率总和 / 商品总数
    - `Avg_Ratio` (平均收藏加购访客比) = 所有商品的收藏加购访客比总和 / 商品总数
    - `Avg_SearchClickRate` (平均搜索点击率) = 所有商品的搜索点击率总和 / 商品总数
    - `Ratio` (单商品收藏加购访客比) = (该商品收藏人数 + 该商品加购人数) / 该商品访客数

- **分类逻辑（严格按优先级排序）**：
    1. **潜力商品**: 若 `Ratio > Avg_Ratio` **且** `搜索点击率 > Avg_SearchClickRate` **且** `Ratio > 0.1` (即 > 10%)
    2. **高转化低访客**: 若 `支付转化率 > Avg_CR` 且 `访客数 < Avg_V`
    3. **高访客低转化**: 若 `访客数 > Avg_V` 且 `支付转化率 < Avg_CR`

- **过滤机制**：仅在结果表格中展示符合上述三类定义的商品。

## 5. 运营建议内容（直接嵌入代码）
- **潜力商品**: 1，对标热销竞品，优化价格。2，标题和详情页增加产品相关的热搜词。3，设置低门槛Code、满减折等促销活动，快速积累基础销量和好评。4，开直通车测试ROI。5，报名平台活动。
- **高转化低访客**: 该商品具备优质转化潜力，需加大广告投放力度。① 先开2周左右的智能投，测试关键词点击和出价。② 监控广告数据，及时调整投放预算与定向策略，提升 ROI。③ 多报名平台活动，获得更多的导购流量。
- **高访客低转化**: 该商品获客能力较强但转化效率不足，需系统性优化支付转化率。① 销量与好评优化：通过小额促销、捆绑销售提升基础销量，主动引导已购用户晒图评价，补充真实使用场景反馈；② 价格调整：对比同类竞品价格带，适当下调价格或设置优惠券、满减活动，降低购买门槛；③ 详情页优化：重构页面逻辑，首屏突出核心卖点与差异化优势，中间部分补充规格参数、售后保障、物流时效等关键信息，尾部添加用户评价与使用教程，提升信息可信度。

## 6. UI/UX 界面需求
- **初始状态**: 展示一个现代化的拖拽上传区域（Tailwind 风格，带虚线边框）。
- **结果展示**:
    - 上传完成后，隐藏上传区，展示数据表格。
    - 表格列：[商品 ID, 商品分类, 运营建议]。
    - 运营建议内容分点显示，不使用列表符号，直接显示文本。
    - 分类标签使用不同颜色：潜力商品（绿色）、高转化低访客（蓝色）、高访客低转化（橙色）。
- **导出功能**: 结果页面右上角提供绿色的"导出结果"按钮，可下载包含统计信息和商品分析结果的 Excel 文件。
- **重置功能**: 右下角固定位置提供红色的"清空数据并重新开始"按钮，点击后重置所有状态，回到上传初始页面。
- **微信社群**: 右下角提供绿色微信图标按钮（位于重置按钮上方），点击弹出"速卖通纯卖家交流群"二维码弹窗。

## 7. 导出功能需求
- 点击"导出结果"按钮后，生成 Excel 文件并自动下载。
- 文件名格式：`速卖通商品数据分析_YYYYMMDD_HHMM.xlsx`
- Excel 内容包含：
    - 标题行（合并居中）
    - 统计信息：分析商品总数、符合分类条件商品数、平均访客数、平均支付转化率、平均收藏加购访客比、平均搜索点击率
    - 数据表格：商品ID、商品分类、运营建议
- Excel 格式：
    - 表头带浅蓝色背景
    - 自动换行显示长文本
    - 列宽自适应（运营建议列较宽）
    - 统计信息标签加粗并带灰色背景

## 8. 微信社群弹窗需求
- **触发方式**: 点击页面右下角的绿色微信图标按钮（MessageCircle 图标）
- **弹窗内容**:
    - 标题："速卖通纯卖家交流群"
    - 副标题："扫码加入，与优秀卖家一起交流"
    - 二维码图片：`/public/erweima.jpg`
    - 提示文字："微信扫描上方二维码即可加入群聊"
- **交互方式**:
    - 点击遮罩层关闭弹窗
    - 点击右上角 X 按钮关闭弹窗
    - 弹窗带淡入动画效果
- **样式设计**:
    - 白色圆角卡片
    - 居中显示
    - 二维码区域 192x192px

## 9. 项目结构
```
├── app/
│   ├── layout.tsx          # 根布局（支持中文）
│   ├── page.tsx            # 主应用页面
│   └── globals.css         # Tailwind 样式
├── components/
│   ├── FileUploader.tsx    # 拖拽上传组件
│   ├── ResultsTable.tsx    # 结果表格展示（含导出按钮）
│   ├── ResetButton.tsx     # 重置按钮组件
│   └── WeChatModal.tsx     # 微信社群弹窗组件
├── lib/
│   ├── recommendations.ts  # 运营建议数据
│   ├── encodings.ts        # CSV 编码检测
│   ├── fileProcessor.ts    # 文件解析（CSV/XLSX）
│   ├── dataAnalyzer.ts     # 数据分析引擎
│   └── exportExcel.ts      # Excel 导出功能
├── types/
│   └── index.ts            # TypeScript 类型定义
├── public/
│   └── erweima.jpg         # 微信群二维码图片
└── package.json
```

## 10. 执行步骤
1. 安装依赖：
   ```bash
   npm install next react react-dom typescript @types/react @types/node
   npm install xlsx xlsx-js-style papaparse jschardet lucide-react
   npm install -D @types/papaparse tailwindcss postcss autoprefixer eslint eslint-config-next
   ```
2. 配置 Tailwind CSS 和 TypeScript
3. 创建类型定义文件 `types/index.ts`
4. 实现核心逻辑库（lib 目录下各文件）
5. 实现 UI 组件（components 目录下各文件）
6. 集成到主页面 `app/page.tsx`
7. 将微信二维码图片放置在 `public/erweima.jpg`
8. 确保样式美观、整洁，适配中文排版

## 11. 关键实现要点
- 所有数据处理在浏览器本地完成，不依赖后端 API
- CSV 文件必须正确处理 GBK 编码
- 分类逻辑按优先级顺序判断（潜力商品 > 高转化低访客 > 高访客低转化）
- 导出的 Excel 文件格式美观，便于阅读和分享
- 响应式设计，支持不同屏幕尺寸
- 微信弹窗支持优雅的开关动画
- 二维码图片需要放置在 public 目录下才能正确加载
